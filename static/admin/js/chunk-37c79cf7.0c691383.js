(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37c79cf7"],{1540:function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"e",function(){return i}),n.d(e,"f",function(){return r}),n.d(e,"a",function(){return s}),n.d(e,"b",function(){return c}),n.d(e,"g",function(){return u}),n.d(e,"d",function(){return l});var a=n("66df"),o=function(t){return a["a"].request({url:"/api/forum/category/",headers:{Authorization:"JWT "+t},method:"get"})},i=function(t,e){return a["a"].request({url:"/api/forum/category/"+t+"/",headers:{Authorization:"JWT "+e},method:"get"})},r=function(t,e,n){return a["a"].request({url:"/api/forum/category/"+t+"/",headers:{Authorization:"JWT "+n},data:e,method:"put"})},s=function(t,e){return a["a"].request({url:"/api/forum/category/",headers:{Authorization:"JWT "+e},data:t,method:"post"})},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return a["a"].request({url:"/api/forum/?title="+e+"&category="+n,headers:{Authorization:"JWT "+t},method:"get"})},u=function(t,e){return a["a"].request({url:"/api/forum/"+e+"/",headers:{Authorization:"JWT "+t},method:"delete"})},l=function(t,e,n){return a["a"].request({url:"/api/forum/"+e+"/",headers:{Authorization:"JWT "+t},data:n,method:"PATCH"})}},"59b0":function(t,e,n){"use strict";var a=n("e8cc"),o=n.n(a);o.a},c31a:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Card",{attrs:{bordered:!1}},[n("p",{attrs:{slot:"title"},slot:"title"},[t._v("帖子")]),n("Row",[n("Col",{attrs:{span:"18"}},[n("Col",{staticStyle:{display:"flex"},attrs:{span:"6"}},[n("span",{staticStyle:{width:"50px","padding-top":"5px"}},[t._v("分类：")]),n("Select",{attrs:{placeholder:"请选择"},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.select,function(e,a){return n("Option",{attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1),n("Col",{staticStyle:{display:"flex"},attrs:{span:"6"}},[n("span",{staticStyle:{width:"60px","padding-top":"5px","margin-left":"10px"}},[t._v("标题：")]),n("Input",{attrs:{placeholder:"请输入标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),n("Col",{staticStyle:{display:"flex"},attrs:{span:"4"}},[n("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.search}},[t._v("搜索")])],1)],1),n("Col",{staticStyle:{display:"flex","justify-content":"flex-end"},attrs:{span:"6"}},[n("Button",{attrs:{type:"primary",icon:"ios-add",to:{name:"articleAdd"}}},[t._v("新增文章")])],1)],1),n("Row",[n("Col",{staticStyle:{"margin-top":"15px"},attrs:{span:"24"}},[n("Table",{attrs:{border:"",columns:t.columns,data:t.data},scopedSlots:t._u([{key:"id",fn:function(e){e.row;var a=e.index;return[n("span",[t._v(t._s(a+1))])]}},{key:"username",fn:function(e){var a=e.row;e.index;return[n("span",[t._v(t._s(a.authors.username))])]}},{key:"title",fn:function(e){var a=e.row;e.index;return[n("span",{staticStyle:{display:"-webkit-box",overflow:"hidden","text-overflow":"ellipsis","-webkit-box-orient":"vertical","-webkit-line-clamp":"3"}},[t._v(t._s(a.title))])]}},{key:"click_nums",fn:function(e){var a=e.row;e.index;return[n("span",[t._v(t._s(a.click_nums))])]}},{key:"category",fn:function(e){var a=e.row;e.index;return[n("span",[t._v(t._s(a.category.name))])]}},{key:"add_time",fn:function(e){var a=e.row;e.index;return[n("span",[t._v(t._s(a.add_time))])]}},{key:"action",fn:function(e){var a=e.row;e.index;return[0==a.hidden?n("Button",{attrs:{type:"warning",size:"small"},on:{click:function(e){return t.update(a.id,1)}}},[t._v("关闭帖子")]):1==a.hidden?n("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.update(a.id,0)}}},[t._v("开启帖子")]):t._e(),n("Button",{staticClass:"text-right",attrs:{type:"error",size:"small"},on:{click:function(e){return t.remove(a.id)}}},[n("Icon",{attrs:{type:"ios-trash-outline",size:"20"}}),t._v("删除")],1)]}}])}),n("Page",{ref:"currents",attrs:{total:t.count,"show-elevator":"","page-size":t.pageSize,"show-total":""},on:{"on-change":t.page}})],1)],1),n("Modal",{attrs:{title:"删除帖子"},on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[n("p",[t._v("是否要删除此帖子?")])]),n("Modal",{attrs:{title:"关闭帖子"},on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[n("p",[t._v("是否要删除此帖子?")])])],1)],1)},o=[],i=n("1540"),r=n("c276"),s=n("66df"),c=n("90de"),u={data:function(){return{select:[],selected:"",title:"",id:"",modal1:!1,columns:[{title:"序号",slot:"id"},{title:"作者",slot:"username"},{title:"标题",slot:"title"},{title:"阅读量",slot:"click_nums"},{title:"分类",slot:"category"},{title:"时间",slot:"add_time"},{title:"操作",slot:"action"}],count:0,pageSize:10,data:[]}},created:function(){var t=this;this.$Spin.show(),Object(i["b"])(Object(r["k"])("token")).then(function(e){200==e.status&&(t.data=e.data.results,t.count=e.data.count,t.$Spin.hide())}),Object(i["c"])(Object(r["k"])("token")).then(function(e){t.select=e.data})},computed:{access:function(){return this.$store.state.user.access},viewAccessAll:function(){return Object(c["c"])(["is_staff"],this.access)},viewAccessSuper:function(){return Object(c["c"])(["is_superuser"],this.access)}},methods:{search:function(){var t=this;this.$Spin.show(),Object(i["b"])(Object(r["k"])("token"),this.title,this.selected).then(function(e){200==e.status&&(t.$refs.currents.currentPage=1,t.data=e.data.results,t.count=e.data.count,t.$Spin.hide())})},page:function(t){var e=this;this.$Spin.show(),s["a"].request({url:"/api/forum/?page="+t+"&title="+this.title+"&category="+this.selected,headers:{Authorization:"JWT "+Object(r["k"])("token")},method:"get"}).then(function(t){200==t.status&&(e.data=t.data.results,e.count=t.data.count,e.$Spin.hide())})},ok:function(){var t=this;Object(i["g"])(Object(r["k"])("token"),this.id).then(function(e){t.$Message.info("删除成功"),t.data.map(function(e,n){-1!=e.id.indexOf(t.id)&&(t.data.splice(n,1),t.count=t.count-1)})})},cancel:function(){this.$Message.info("已取消")},remove:function(t){this.modal1=!0,this.id=t},update:function(t,e){var n=new FormData;n.append("hidden",e),Object(i["d"])(Object(r["k"])("token"),t,n).then(function(t){console.log(t)})}}},l=u,d=(n("59b0"),n("2877")),p=Object(d["a"])(l,a,o,!1,null,"47fcd7d2",null);e["default"]=p.exports},e8cc:function(t,e,n){}}]);